# RS-Knight Stego

A robust image steganography system that combines Reed-Solomon error correction with Knight's Tour path selection for secure and resilient data hiding.

## Overview

This project implements an advanced steganography technique that embeds secret messages into digital images with error correction capabilities. The system uses:

- **Reed-Solomon (RS) error correction codes** for data integrity and recovery
- **Knight's Tour algorithm** for pseudo-random pixel path selection  
- **LSB (Least Significant Bit)** embedding for data storage
- **LSB2 (Second Least Significant Bit)** embedding for parity data

The implementation is based on academic research and provides both embedding and extraction capabilities along with comprehensive analysis tools.

## Features

### Core Functionality
- **Secure Data Embedding**: Hide text messages or binary data within images
- **Error Correction**: Reed-Solomon codes protect against noise and compression artifacts
- **Path Randomization**: Knight's Tour provides cryptographically secure pixel selection
- **Multi-format Support**: Works with TIFF, PNG, and other lossless image formats

### Analysis Tools
- **RS Analysis**: Detect potential steganographic content using statistical analysis
- **Chi-square Attack**: Implement chi-square steganalysis for security testing
- **Oracle Detector**: Advanced detection mechanisms for security evaluation
- **Visual Quality Metrics**: PSNR and other image quality assessments

### Evaluation Framework
- **Noise Resilience Testing**: Salt-and-pepper noise simulation
- **Capacity Analysis**: Determine optimal payload sizes
- **Security Assessment**: Comprehensive steganalysis resistance testing

## Installation

### Prerequisites
- Python 3.7 or higher
- pip package manager

### Setup
1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/RS-Knight-Stego.git
   cd RS-Knight-Stego
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Quick Start

### Basic Usage

#### Embedding Data
```python
from stegano.encoder import StegoEncoder

# Initialize encoder with a seed for reproducible results
encoder = StegoEncoder(seed=123)

# Embed message into image
message = b"This is a secret message!"
encoder.encode_image(
    input_path="images/cover/example.tiff",
    output_path="output/stego.tiff", 
    data=message
)
```

#### Extracting Data
```python
from stegano.decoder import StegoDecoder

# Initialize decoder with the same seed
decoder = StegoDecoder(seed=123)

# Extract hidden message
recovered_data = decoder.decode_image("output/stego.tiff")
print("Recovered message:", recovered_data.decode('utf-8'))
```

### Advanced Examples

#### Noise Resilience Testing
```python
from stegano.encoder import StegoEncoder
from stegano.decoder import StegoDecoder
from evaluation.visualizer import add_salt_pepper_noise

# Embed data
encoder = StegoEncoder(seed=42)
message = b"Testing error correction capabilities"
encoder.encode_image("images/cover/test.tiff", "output/stego.tiff", message)

# Add noise to test robustness
noisy_image = add_salt_pepper_noise("output/stego.tiff", amount=0.01)

# Attempt extraction from noisy image
decoder = StegoDecoder(seed=42)
recovered = decoder.decode_image(noisy_image)

print("Original:", message)
print("Recovered:", recovered)
print("Success:", message == recovered)
```

#### Steganalysis Detection
```python
from rs_analysis.rs_analyzer import RSAnalyzer
import cv2

# Load and analyze image
analyzer = RSAnalyzer()
image = cv2.imread("suspicious_image.tiff")
image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)

# Check for steganographic content
if analyzer.is_stego(image_rgb, debug=True):
    print("⚠️  Steganographic content detected")
else:
    print("✅ Image appears clean")
```

## Technical Details

### Algorithm Overview

1. **Data Preparation**: 
   - Input data is prefixed with a 4-byte length header
   - Data is segmented into 4-byte blocks for processing

2. **Error Correction Encoding**:
   - Each 4-byte block is encoded using Reed-Solomon RS(7,4)
   - Produces 4 bytes of data + 3 bytes of parity information

3. **Path Generation**:
   - Knight's Tour algorithm generates pseudo-random pixel coordinates
   - Ensures uniform distribution and avoids predictable patterns

4. **Embedding Process**:
   - Data bits embedded in RGB LSB positions (3 bits per pixel)
   - Parity bits embedded in RGB LSB2 positions  
   - Requires 12 pixels per 4-byte data block

5. **Extraction and Recovery**:
   - Reverse process extracts embedded bits
   - Reed-Solomon decoder corrects errors and recovers original data

### Configuration Parameters

Key parameters can be adjusted in `config.py`:

```python
# Reed-Solomon code parameters
RS_N = 255  # Total codeword length
RS_K = 223  # Data portion length

# Analysis parameters  
MASK_SIZE = (8, 8)    # Analysis window size
THRESHOLD = 0.1       # Detection threshold
MAX_ITERS = 5         # Maximum iterations
TOP_PERCENT = 0.05    # Top percentage for analysis
```

## Project Structure

```
RS-Knight-Stego/
├── stegano/              # Core steganography modules
│   ├── encoder.py        # Data embedding implementation
│   ├── decoder.py        # Data extraction implementation  
│   ├── knight.py         # Knight's Tour path generation
│   ├── rs_coder.py       # Reed-Solomon error correction
│   └── utils.py          # Utility functions for bit manipulation
├── rs_analysis/          # Steganalysis tools
│   ├── rs_analyzer.py    # RS analysis implementation
│   └── utils.py          # Analysis utilities
├── evaluation/           # Testing and evaluation tools
│   ├── evaluate.py       # Performance evaluation
│   ├── metrics.py        # Quality metrics (PSNR, etc.)
│   └── visualizer.py     # Visualization and noise simulation
├── oracle/               # Advanced detection methods
│   ├── oracle_detector.py    # Oracle-based detection
│   ├── attack_strategy.py    # Attack implementations
│   └── pixel_modifier.py     # Pixel manipulation tools
├── examples/             # Usage examples and demos
├── images/               # Sample images
│   ├── cover/           # Original cover images
│   └── stego/           # Generated steganographic images
├── tests/               # Unit tests and validation
└── docs/                # Additional documentation
```

## Research Background

This implementation is based on academic research in digital steganography and error correction coding. The system addresses key challenges in information hiding:

- **Robustness**: Reed-Solomon codes provide resilience against noise and compression
- **Security**: Knight's Tour path selection resists statistical analysis  
- **Capacity**: Efficient embedding maximizes payload while maintaining quality
- **Detectability**: Advanced techniques minimize statistical artifacts

## Performance Characteristics

### Embedding Capacity
- **Payload**: ~0.375 bits per pixel (bpp) for color images
- **Overhead**: ~75% due to error correction coding
- **Quality**: Typically >40 dB PSNR with minimal visual impact

### Error Correction Capability  
- **Correction**: Up to 1-2 bit errors per 7-byte codeword
- **Noise Resilience**: Survives 1-3% salt-and-pepper noise
- **Compression**: Limited resilience to lossy compression

## Contributing

We welcome contributions to improve the system! Please:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/improvement`)
3. Commit your changes (`git commit -am 'Add new feature'`)
4. Push to the branch (`git push origin feature/improvement`)
5. Create a Pull Request

### Development Guidelines
- Follow PEP 8 style guidelines
- Add unit tests for new functionality
- Update documentation for API changes
- Test with multiple image formats and sizes

## Testing

Run the test suite:
```bash
python -m pytest tests/
```

For manual testing:
```bash
python examples/example.py
```

## Citation

If you use this code in your research, please cite:

```bibtex
@misc{rs-knight-stego,
  title={RS-Knight Stego: Robust Image Steganography with Reed-Solomon Error Correction},
  author={[Your Names]},
  year={2024},
  url={https://github.com/your-username/RS-Knight-Stego}
}
```

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Acknowledgments

- Reed-Solomon implementation based on the `reedsolo` library
- Knight's Tour algorithm adapted from classical implementations
- Steganalysis techniques based on published research literature

## Contact

For questions or collaboration opportunities, please open an issue or contact the maintainers.
